P <- matrix(0, nrow = 9, ncol = 9)
P[1,1] <- 1
P[1,2] <- 1
P[1,3] <- 1
P[2,1] <- 1
P[2,2] <- 1
P[2,3] <- 1
P[3,1] <- 1
P[3,2] <- 1
P[3,3] <- 1
P
P <- matrix(0, nrow = 9, ncol = 9)
P[1,1] <- 1
P[1,2] <- 1
P[1,3] <- 1
P
P <- matrix(0, nrow = 9, ncol = 9)
P[1,1] <- 1
P[4,2] <- 1
P[7,3] <- 1
P[2,4] <- 1
P[5,5] <- 1
P[8,6] <- 1
P[3,7] <- 1
P[6,8] <- 1
P[9,9] <- 1
P
K_bar <- matrix(c(1,0.1,0.1,1), 2)
K_bar
chol(K_bar)
chol(K_bar, T)
K_bar <- t(chol(matrix(c(1,0.1,0.1,1), 2)))
K_bar
K_bar <- matrix(c(1,0.1,0.1,1), 2))
K_bar <- matrix(c(1,0.1,0.1,1), 2)
(K_bar <- matrix(c(1,0.1,0.1,1), 2))
(K_bar <- matrix(c(1.0, 0.3, 0.1,
0.3, 1.0, 0.1,
0.1, 0.3 ,1.0), 2))
(K_bar <- matrix(c(1.0, 0.3, 0.1,
0.3, 1.0, 0.1,
0.1, 0.3 ,1.0), 3))
(K_bar <- matrix(c(1.0, 0.3, 0.1,
0.3, 1.0, 0.1,
0.1, 0.3 ,1.0), 3, byrow = T))
(K_bar <- matrix(c(1.0, 0.3, 0.1,
0.3, 1.0, 0.3,
0.1, 0.3 ,1.0), 3, byrow = T))
chol(K_bar)
D <- matrix(0, 9,9)
D
D[1:3, 1:3] <- D
D[4:6, 4:6] <- D
D[7:9, 7:9] <- D
D <- matrix(0,9,9)
D[1:3, 1:3] <- K_bar
D[4:6, 4:6] <- K_bar
D[7:9, 7:9] <- K_bar
t(chol(
D
-D
(K_bar <- matrix(c(1.0, 0.3, 0.1,
0.3, 1.0, 0.3,
0.1, 0.3 ,1.0), 3, byrow = T))
K_big <- matrix(0,9,9)
K_big[1:3, 1:3] <- K_bar
K_big[4:6, 4:6] <- K_bar
K_big[7:9, 7:9] <- K_bar
K_big %*% P
-(K_big %*% P)
chol(K_big %*% P)
chol(K_big %*% P)
chol(K_big)
library(cowplot)
g_point_line_color +
geom_point()+
geom_line(aes(color = y))
#| fig-align: "center"
g <- ggplot(mapping = aes(x = x, y = y))
library(ggplot2)
#| fig-align: "center"
g <- ggplot(mapping = aes(x = x, y = y))
g_point_line_color <- g +
geom_point()+
geom_line(aes(color = y))
g_point_line_color
foo <- function(x) sin(x) + cos(x*0.5)
x <- seq(0, 20, len = 100)
y <- foo(x)
g +
geom_point()+
geom_line(aes(color = y))
g_point_line_color <- g +
geom_point(color = "darkorange", width=3)+
geom_line(aes(color = y))
g_point_line_color <- g +
geom_point(color = "darkorange", size=3)+
geom_line(aes(color = y))
g_point_line_color
g_point_line_color <- g +
geom_point(color = "darkorange")+
geom_line(aes(color = y, size=3))
g_point_line_color <- g +
geom_point(color = "darkorange")+
geom_line(aes(color = y, linewidth=3))
g_point_line_color
g_point_line_color <- g +
geom_point(color = "darkorange")+
geom_line(aes(color = y, linewidth=2))
geom_point(color = "darkorange")+
g_point_line_color <- g +
geom_point(color = "darkorange")+
geom_line(aes(color = y, linewidth=2))
g_point_line_color
g_point_line_color <- g +
geom_point(color = "darkorange")+
geom_line(aes(color = y), , linewidth=2)
g_point_line_color
g_point_line_color <- g +
geom_line(aes(color = y), , linewidth=2)
g_point_line_color
g_point_line_color <- g +
geom_line(aes(color = y), , linewidth=2)+
geom_point(color = "darkorange")
g_point_line_color
cut(iris$Sepal.Length)
iris$Sepal.Length
table(iris$Species)
cars
cars$speed %>% table
library(magrittr)
cars$speed %>% table
mtcars %>% head
mtcars %>% str
mtcars$cyl
mtcars$cyl %>% table
?geom_bar
ggplot(mtcars, aes(cyl))+
geom_bar()
data <- mtcars
data$cyl <- as.factor(data$cyl)
ggplot(mtcars, aes(cyl))+
geom_bar()
ggplot(data, aes(cyl))+
geom_bar()
?mtcars
ggplot(data, aes(cyl, color = vs))+
geom_bar()
data$vs <- as.factor(data$vs)
ggplot(data, aes(cyl, color = vs))+
geom_bar()
ggplot(data, aes(cyl, fill = vs))+
geom_bar()
ggplot(data, aes(cyl, fill = vs))+
geom_bar(position = "dodge")
#| fig-align: "center"
ggplot(data, aes(mpg))+
geom_histogram()
#| fig-align: "center"
ggplot(data, aes(mpg))+
geom_histogram(breaks = 10)
#| fig-align: "center"
ggplot(data, aes(mpg))+
geom_histogram(bins = 10)
str(mtcars)
#| fig-align: "center"
ggplot(data, aes(hp))+
geom_histogram(bins = 10)
#| fig-align: "center"
ggplot(data, aes(wt))+
geom_histogram(bins = 10)
names(iris)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length))+
geom_histogram(bins = 10)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length))+
geom_histogram(bins = 20)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, color = Species))+
geom_histogram(bins = 20)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20, alpha = 0.4)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20, alpha = 0.8)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20, alpha = 0.6)
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20, alpha = 0.6, position = "dodge")
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20, alpha = 0.6, position = "identity")
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20, alpha = 0.6, position = "identity")
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 20, alpha = 0.4, position = "identity")
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 40, alpha = 0.4, position = "identity")
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 30, alpha = 0.4, position = "identity")
?scale_fill_manual
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 30, alpha = 0.4, position = "identity")+
scale_fill_manual(c("red", "blue", "green"))
#| fig-align: "center"
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 30, alpha = 0.4, position = "identity")+
scale_fill_manual(values = c("red", "blue", "green"))
ggplot(iris, aes(Sepal.Length, fill = Species))+
geom_histogram(bins = 30, alpha = 0.4, position = "identity")+
scale_fill_manual(values = c("red", "blue", "green"))
#| fig-align: "center"
ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species))+
geom_boxplot()
ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species))+
geom_boxplot()
?geom_boxplot
ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species))+
geom_violin()+
geom_boxplot(size = 0.1)
ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species))+
geom_violin()+
geom_boxplot(size = 0.1)
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density_2d()
#
?geom_density2d
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d()
#| fig-align: "center"
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
geom_point(aes(mean(Sepal.Width), mean(Sepal.Length)))
?annotate
#| fig-align: "center"
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate(geomn_point, mean(Sepal.Width), mean(Sepal.Length))
#| fig-align: "center"
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate(geom_point, mean(Sepal.Width), mean(Sepal.Length))
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate(geom_point, mean(Sepal.Width), mean(Sepal.Length))
#| fig-align: "center"
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate("point", mean(iris$Sepal.Width), mean(iris$Sepal.WidthSepal.Length))
mean(iris$Sepal.Width)
mean(iris$Sepal.WidthSepal.Length)
#| fig-align: "center"
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate("point", mean(iris$Sepal.Width), mean(iris$Sepal.Length))
#| fig-align: "center"
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate("point", mean(iris$Sepal.Width), mean(iris$Sepal.Length), color = "red")
#| fig-align: "center"
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate("point", mean(iris$Sepal.Width), mean(iris$Sepal.Length), color = "red")+
annotate("text", mode(iris$Sepal.Width), mode(iris$Sepal.Length), color = "red", label="mode")
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate("point", mean(iris$Sepal.Width), mean(iris$Sepal.Length), color = "red")+
annotate("text", mode(iris$Sepal.Width), mode(iris$Sepal.Length), color = "red", label="mode")
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length))+
geom_density2d_filled()+
annotate("point", mean(iris$Sepal.Width), mean(iris$Sepal.Length), color = "red")
mode(iris$Sepal.Width)
modeest
install.packages("modeest", Ncpus = 5)
# calc mode
mx <- modeest::mfv(iris$Sepal.Width)
my <- modeest::mfv(iris$Sepal.Length)
mx
my
iris$Sepal.Width
mxx <- sort(-table(iris$Sepal.Width))[1]
myy <- sort(-table(iris$Sepal.Length))[1]
mxx
myy
?modeest::mfv
quarto::quarto_publish_site()
library(dplyr)
```{r, message=FALSE}
library(dplyr)
# Without using pipe operator
numbers <- list(1, 2, 3, 4)
sum_of_squares <- sum(
sapply(
numbers,
function(x) x^2
)
)
rnorm(3) |> sum()
rnorm(3) |> sum
rnorm(3) %>%  sum
starwars
tibble(iris)
tibble(iris)
starwars
names(starwars)
starwars %>%
filter(height > 180) %>%
select(name, homeworld)
head(starwars)
starwars %>%
filter(height > 180) %>%
select(1)
starwars %>%
filter(1:4) %>%
select(1)
?starwars
starwars %>%
muate(bmi = mass / height^2)
starwars %>%
mutate(bmi = mass / height^2)
starwars %>%
mutate(bmi = mass / (height/100)^2)
starwars
starwars %>%
group_by(eye_color)
names(starwars)
starwars %>%
group_by(species, homeworld) %>%
summarise(
mean_height = mean(height),
mean_weight = mean(mass),
)
starwars %>%
group_by(species, homeworld) %>%
summarise(
mean_height = mean(height),
mean_weight = mean(mass),
)
starwars %>%
group_by(species, homeworld) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
)
starwars %>%
group_by(species, homeworld) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
)
starwars %>%
group_by(species, sex) %>%
select(height, mass) %>%
summarise(
height = mean(height, na.rm = TRUE),
mass = mean(mass, na.rm = TRUE)
)
starwars %>%
group_by(species, homeworld) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
)
starwars %>%
group_by(species) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
)
starwars %>%
group_by(species) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
) %>%
desc
?desc
?arrange
starwars %>%
group_by(species) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
) %>%
arrange(mean_height)
starwars %>%
group_by(species) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
) %>%
arrange(desc(mean_height))
starwars %>%
group_by(species) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
) %>%
arrange(desc(mean_weight))
starwars %>% filter(species == "Kaleesh")
library(data.table)
data.table(starwars)
setDT(starwars)
head(sw_dt)
sw_dt <- starwars
head(sw_dt)
?map
map
Map
?Map
max(iris+)
max(iris)
iris
max(iris[, 1:4])
?data.table::fread
sw_dt[,.(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE)
), by = species]
sw_dt[height > 170 & mass < 130, .(name, homeworld)]
library(data.table)
sw_dt <- starwars
setDT(sw_dt)
sw_dt[height > 170 & mass < 130, .(name, homeworld)]
sw_dt[,.(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE)
), by = species]
starwars %>%
group_by(species) %>%
summarise(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE),
) %>%
arrange(desc(mean_weight))
sw_dt[order(-mean_weight),.(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE)
), by = species]
), by = species][order(-mean_weight,]
sw_dt[,.(
mean_height = mean(height, na.rm = TRUE),
mean_weight = mean(mass, na.rm = TRUE)
), by = species][order(-mean_weight),]
starwars[species == "Human", .N]
starwars[,.N, by = "species"]  # 35 humans in the data set
starwars[,.N, by = species]  # 35 humans in the data set
starwars[species == "Wooliee"]
starwars[species == "Wookiee"]
starwars[,.N, by = species]
starwars[,.N, by = species]
starwars[,.N, by = .(species)]
starwars[,.(.N), by = .(species)]
starwars[,.N, by = species]
starwars[1:5,.N, by = species]
starwars[,.N, by = species]
head(starwars[,.N, by = species])
sw_dt
sw_dt
sw_dt %>% names
minmax
range(1:4)
dw_dt[, .(sex, gener)]
sw_dt[, .(sex, gender)]
?range
sw_dt[,.(minimum = min(height, na.rm = T), maximum = (max(height, na.rm = T), .N)
sw_dt[,.(minimum = min(height, na.rm = T), maximum = (max(height, na.rm = T)), .N), by = .(species, gender)]
# sw_dt[,.(minimum = min(height, na.rm = T), maximum = (max(height, na.rm = T)), .N), by = .(species, gender)]
sw_dt[,.(range(height, na.rm=T), .N), by = .(species, gender)]
a := 1
sw_dt[, c("mean bmi", "bmi_from_means") := .(sum(mass / (height/100)^2)/.N,
mean(mass) / (mean(height)/100)^2),
by = species]
sw_dt
?sum
sw_dt[, c("mean bmi", "bmi_from_means") := .(sum(mass / (height/100)^2, na.rm=T)/.N,
mean(mass, na.rm=T) / (mean(height, na.rm=T)/100)^2),
by = species]
sw_dt
sw_dt[, c("mean_bmi", "bmi_from_means") := .(sum(mass / (height/100)^2, na.rm=T)/.N,
mean_bmi),
by = species]
sw_dt[, c("mean_bmi", "bmi_from_means") := .(sum(mass/(height/100)^2, na.rm=T)/.N,
weight/sum(mass)*100),
by = species]
sw_dt[, c("mean_bmi", "bmi_from_means") := .(sum(mass/(height/100)^2, na.rm=T)/.N,
mass/sum(mass)*100),
by = species]
sw_dt
sw_dt[, c("mean_bmi", "mass_contrib") := .(sum(mass/(height/100)^2, na.rm=T)/.N,
mass/sum(mass)*100),
by = species]
mass/sum(mass)*100),
sw_dt
sw_dt[, c("mean_bmi", "mass_contrib") := .(sum(mass/(height/100)^2, na.rm=T)/.N,
mass/sum(mass, na.rm = T)*100),
by = species]
sw_dt
setwd("~/LEHRE/r_course_materials")
